<% content_for :title, "Admin — #{@event.title}" %>

<div class="d-flex justify-content-between align-items-center mb-4">
  <h2 class="mb-0"><%= @event.title %></h2>
  <div class="d-flex gap-2">
    <%= link_to "Modifier", edit_admin_event_path(@event), class: "btn btn-outline-warning btn-sm" %>
    <%= link_to "Validation", admin_event_submission_path(@event), class: "btn btn-outline-secondary btn-sm" %>
    <%= link_to "← Liste", admin_events_path, class: "btn btn-outline-secondary btn-sm" %>
  </div>
</div>

<%# Statut %>
<div class="mb-4">
  <% if @event.validated.nil? %>
    <span class="badge bg-warning text-dark fs-6">⏳ En attente de validation</span>
  <% elsif @event.validated? %>
    <span class="badge bg-success fs-6">✅ Validé</span>
  <% else %>
    <span class="badge bg-danger fs-6">❌ Refusé</span>
  <% end %>
</div>

<div class="row g-4">
  <%# Photo %>
  <% if @event.photo.attached? %>
    <div class="col-12">
      <%= image_tag @event.photo, class: "img-fluid rounded", style: "max-height: 300px; object-fit: cover; width: 100%;" %>
    </div>
  <% end %>

  <%# Détails %>
  <div class="col-md-8">
    <div class="card border-secondary">
      <div class="card-body">
        <p class="card-text"><%= @event.description %></p>
        <dl class="row mt-3">
          <dt class="col-sm-4 text-muted">Organisateur</dt>
          <dd class="col-sm-8">
            <%= link_to @event.user.email, admin_user_path(@event.user), class: "text-warning" %>
          </dd>

          <dt class="col-sm-4 text-muted">Date de début</dt>
          <dd class="col-sm-8"><%= @event.start_date.strftime("%d/%m/%Y à %H:%M") %></dd>

          <dt class="col-sm-4 text-muted">Durée</dt>
          <dd class="col-sm-8"><%= @event.duration %> min (fin : <%= @event.end_date.strftime("%H:%M") %>)</dd>

          <dt class="col-sm-4 text-muted">Lieu</dt>
          <dd class="col-sm-8"><%= @event.location %></dd>

          <dt class="col-sm-4 text-muted">Prix</dt>
          <dd class="col-sm-8"><%= @event.price == 0 ? "Gratuit" : "#{@event.price} €" %></dd>

          <dt class="col-sm-4 text-muted">Participants</dt>
          <dd class="col-sm-8"><%= @event.attendances.count %></dd>

          <dt class="col-sm-4 text-muted">Créé le</dt>
          <dd class="col-sm-8"><%= @event.created_at.strftime("%d/%m/%Y à %H:%M") %></dd>
        </dl>
      </div>
      <div class="card-footer bg-transparent border-secondary">
        <%= button_to "Supprimer cet événement", admin_event_path(@event), method: :delete,
            data: { turbo_confirm: "Supprimer « #{@event.title} » définitivement ?" },
            class: "btn btn-danger btn-sm" %>
      </div>
    </div>
  </div>
</div>

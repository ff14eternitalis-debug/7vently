<% content_for :title, "Admin — Validations" %>

<div class="d-flex justify-content-between align-items-center mb-4">
  <h2 class="mb-0">Validation des événements</h2>
  <%= link_to "← Dashboard", admin_root_path, class: "btn btn-outline-secondary btn-sm" %>
</div>

<%# En attente %>
<h4 class="mb-3">
  En attente
  <span class="badge bg-warning text-dark"><%= @pending.count %></span>
</h4>

<% if @pending.any? %>
  <div class="table-responsive mb-5">
    <table class="table table-dark table-hover table-bordered align-middle">
      <thead class="table-warning text-dark">
        <tr>
          <th>Titre</th>
          <th>Organisateur</th>
          <th>Date</th>
          <th>Lieu</th>
          <th>Prix</th>
          <th>Soumis le</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <% @pending.each do |event| %>
          <tr>
            <td><%= link_to event.title, admin_event_submission_path(event), class: "text-warning text-decoration-none fw-semibold" %></td>
            <td class="small"><%= event.user.email %></td>
            <td class="small"><%= event.start_date.strftime("%d/%m/%Y") %></td>
            <td class="small"><%= event.location %></td>
            <td class="small"><%= event.price %> €</td>
            <td class="text-muted small"><%= event.created_at.strftime("%d/%m/%Y") %></td>
            <td>
              <div class="d-flex gap-1">
                <%= link_to "Examiner", admin_event_submission_path(event), class: "btn btn-warning btn-sm" %>
              </div>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
<% else %>
  <p class="text-muted fst-italic mb-5">Aucun événement en attente de validation.</p>
<% end %>

<%# Validés %>
<h4 class="mb-3">
  Validés récemment
  <span class="badge bg-success"><%= @validated.count %></span>
</h4>

<% if @validated.any? %>
  <div class="table-responsive mb-5">
    <table class="table table-dark table-sm table-bordered align-middle">
      <thead>
        <tr>
          <th>Titre</th>
          <th>Organisateur</th>
          <th>Date</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <% @validated.first(5).each do |event| %>
          <tr>
            <td><%= link_to event.title, admin_event_submission_path(event), class: "text-success text-decoration-none" %></td>
            <td class="small text-muted"><%= event.user.email %></td>
            <td class="small text-muted"><%= event.start_date.strftime("%d/%m/%Y") %></td>
            <td>
              <%= link_to "Revoir", edit_admin_event_submission_path(event), class: "btn btn-outline-secondary btn-sm" %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
<% end %>

<%# Refusés %>
<h4 class="mb-3">
  Refusés récemment
  <span class="badge bg-danger"><%= @rejected.count %></span>
</h4>

<% if @rejected.any? %>
  <div class="table-responsive">
    <table class="table table-dark table-sm table-bordered align-middle">
      <thead>
        <tr>
          <th>Titre</th>
          <th>Organisateur</th>
          <th>Date</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <% @rejected.first(5).each do |event| %>
          <tr>
            <td><%= link_to event.title, admin_event_submission_path(event), class: "text-danger text-decoration-none" %></td>
            <td class="small text-muted"><%= event.user.email %></td>
            <td class="small text-muted"><%= event.start_date.strftime("%d/%m/%Y") %></td>
            <td>
              <%= link_to "Revoir", edit_admin_event_submission_path(event), class: "btn btn-outline-secondary btn-sm" %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
<% end %>
